<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Export Report - BSU Research Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="main-header">
        <div class="header-content">
            <div class="university-logo-section">
                <img src="/img/dione-newheader.png" alt="Batangas State University" class="university-logo">
            </div>
        </div>
        <div class="header-nav">
            <div class="nav-left">
                <button class="hamburger-menu" id="menuToggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
            <div class="nav-right"></div>
        </div>
    </header>

    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    <div class="sidebar-menu" id="sidebarMenu">
        <div class="sidebar-header">
            <h3>Navigation</h3>
            <button class="sidebar-close" id="sidebarClose">
                <i class="fa fa-times"></i>
            </button>
        </div>
        <ul>
            <li><a href="index.html" id="navDashboard">Dashboard</a></li>
            <li><a href="publications.html" id="navPublications">Research Publications</a></li>
            <li><a href="faculty.html" id="navFaculty">Faculty Management</a></li>
            <li><a href="reports.html" id="navReports" class="active">Export Report</a></li>
        </ul>
    </div>

    <main class="main-content">
        <div class="report-export-container">
            <div class="report-header">
                <h1><i class="fa fa-file-excel"></i> Export Quarterly Report</h1>
                <div class="subtitle">Generate Excel report using the monitoring template with filters</div>
            </div>

            <!-- Filters -->
            <section class="report-section report-filters">
                <h2><i class="fa fa-filter"></i> Filters</h2>
                <p class="report-filters-desc">Set the report period, campus, and which publications to include. Then preview before exporting.</p>
                <div class="report-filters-grid">
                    <div class="report-filter-group">
                        <label for="fiscalYear"><i class="fa fa-calendar-alt"></i> Fiscal Year</label>
                        <input type="number" id="fiscalYear" min="2020" max="2030" placeholder="e.g. 2025" aria-label="Fiscal year">
                        <small>Year shown on the report header</small>
                    </div>
                    <div class="report-filter-group">
                        <label for="quarter"><i class="fa fa-calendar-week"></i> Quarter</label>
                        <select id="quarter" aria-label="Quarter">
                            <option value="all">All quarters (full year)</option>
                            <option value="1st">1st (Jan–Mar)</option>
                            <option value="2nd">2nd (Apr–Jun)</option>
                            <option value="3rd">3rd (Jul–Sep)</option>
                            <option value="4th" selected>4th (Oct–Dec)</option>
                        </select>
                    </div>
                    <div class="report-filter-group">
                        <label for="campus"><i class="fa fa-building"></i> Constituent Campus</label>
                        <input type="text" id="campus" placeholder="e.g. ALANGILAN" value="ALANGILAN" aria-label="Campus">
                        <small>Appears on the report cover</small>
                    </div>
                    <div class="report-filter-group">
                        <label for="yearFilter"><i class="fa fa-book"></i> Publication year</label>
                        <select id="yearFilter" aria-label="Filter publications by year">
                            <option value="">All years</option>
                        </select>
                        <small>Limit to a specific year or use all</small>
                    </div>
                </div>
                <div class="report-actions">
                    <button type="button" id="btnPreview" class="btn-preview">
                        <i class="fa fa-eye"></i> Preview Report
                    </button>
                    <button type="button" id="btnResetFilters" class="btn-reset-filters" title="Reset to defaults">
                        <i class="fa fa-undo"></i> Reset
                    </button>
                </div>
            </section>

            <section class="report-section report-preview">
                <h2><i class="fa fa-table"></i> Report Preview</h2>
                <p class="report-preview-hint">Click "Preview Report" to load publications that will be included in the Excel file.</p>
                <div id="previewSummary" class="preview-summary" style="display: none;"></div>
                <div class="report-preview-table-wrap">
                    <table class="report-preview-table" id="previewTable">
                        <thead>
                            <tr>
                                <th>No.</th>
                                <th>Article Title</th>
                                <th>Authors</th>
                                <th>College / Campus</th>
                                <th>Venue</th>
                                <th>Type</th>
                            </tr>
                        </thead>
                        <tbody id="previewTableBody">
                            <tr><td colspan="6" class="preview-empty">No preview loaded. Use filters and click Preview Report.</td></tr>
                        </tbody>
                    </table>
                </div>
                <div id="previewPagination" class="preview-pagination" style="display: none;">
                    <span id="previewPaginationInfo" class="preview-pagination-info"></span>
                    <div class="preview-pagination-controls">
                        <button type="button" id="btnPreviewPrev" class="btn-pagination" title="Previous page"><i class="fa fa-chevron-left"></i> Prev</button>
                        <span id="previewPageNumbers" class="preview-page-numbers"></span>
                        <button type="button" id="btnPreviewNext" class="btn-pagination" title="Next page">Next <i class="fa fa-chevron-right"></i></button>
                    </div>
                </div>
            </section>

            <!-- Export -->
            <section class="report-section report-export-action">
                <button type="button" id="btnExport" class="btn-export">
                    <i class="fa fa-download"></i> Export to Excel
                </button>
                <p id="exportMessage" class="export-message"></p>
            </section>
        </div>
    </main>

    <script src="reports.obf.js"></script>
</body>
</html>
